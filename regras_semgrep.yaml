rules:
  - id: java-problematic-code
    patterns:
      - pattern-either:
          # Detec√ß√£o de SQL Injection
          - pattern: "... + $STR + ..."
            inside: 
              pattern: |
                $STMT.executeQuery("SELECT ... WHERE ... = '" + ... + "'")

          # Vari√°veis p√∫blicas est√°ticas mut√°veis
          - pattern: public static $TYPE $VAR = new ArrayList<...>();

          # Divis√£o por zero potencial
          - pattern: |
              if ($X == 0) {
                  ... / $X ...
              }

          # Uso de classes obsoletas
          - pattern: new Vector(...)

          # Captura gen√©rica de exce√ß√£o
          - pattern: |
              try {
                  ...
              } catch (Exception $E) {
                  ...
              }

          # Hardcoding de senhas
          - pattern: |
              $STR = "password";
              $STR = "senha";

          # Compara√ß√£o insegura de float
          - pattern: $X == $Y
            where: $X.type == "double"

          # Reflex√£o insegura
          - pattern: |
              $FIELD.setAccessible(true)

          # Resource leak
          - pattern: |
              $CONN = DriverManager.getConnection(...)
              ... !$CONN.close()

          # Race condition potencial
          - pattern: |
              $VAR++;

          # NPE potencial
          - pattern: $X.equals($Y)
            where: $X == null

    message: |
      üö© Problemas cr√≠ticos detectados:
      - SQL Injection: Use PreparedStatement
      - Vari√°veis p√∫blicas est√°ticas mut√°veis: Use final ou encapsulamento
      - Poss√≠vel divis√£o por zero
      - Uso de classes obsoletas (Vector)
      - Captura gen√©rica de exce√ß√£o
      - Hardcoding de senhas
      - Compara√ß√£o insegura de float
      - Uso inseguro de reflex√£o
      - Vazamento de recursos
      - Poss√≠vel race condition
      - Null Pointer Exception potencial

      ‚ö†Ô∏è Corrija estes problemas para melhorar a seguran√ßa e qualidade do c√≥digo.
    languages: [java]
    severity: ERROR

  - id: java-code-quality
    patterns:
      # M√©todo synchronized desnecess√°rio
      - pattern: |
          synchronized $RET $METHOD(...) {
              System.out.println(...);
          }

      # Exce√ß√£o suprimida
      - pattern: |
          try {
              ...
          } catch ($E $VAR) {
          }

      # Vari√°vel n√£o inicializada
      - pattern: |
          $TYPE $VAR;
          ... $VAR ...

    message: |
      ‚ö†Ô∏è Problemas de qualidade de c√≥digo:
      - M√©todo synchronized desnecess√°rio
      - Exce√ß√£o suprimida
      - Uso de vari√°vel n√£o inicializada

      üìù Recomenda√ß√µes:
      - Remova synchronized se n√£o houver necessidade
      - Trate adequadamente as exce√ß√µes
      - Inicialize vari√°veis antes do uso
    languages: [java]
    severity: WARNING
